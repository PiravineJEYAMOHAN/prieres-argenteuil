<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f172a">

<!-- Icône Android -->
<link rel="icon" type="image/png" sizes="192x192" href="2800332.png">
<link rel="icon" type="image/png" sizes="512x512" href="2800332.png">

  <title>Horaires de prière</title>

  <!-- Responsive pour téléphone -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      background: #0f172a;
      color: #e5e7eb;
      display: flex;
      justify-content: center;
    }

    /* GRID responsive */
    .container {
      display: grid;
      gap: 20px;
      width: 100%;
      max-width: 900px;
    }

    @media (min-width: 700px) {
      .container {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    .card {
      background: #020617;
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 18px 45px rgba(0,0,0,0.35);
      border: 1px solid #1f2937;
    }

    .title {
      font-size: 16px;
      font-weight: 600;
      color: #38bdf8;
      text-transform: uppercase;
      margin-bottom: 6px;
    }

    .city {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .date {
      font-size: 12px;
      color: #9ca3af;
      margin-bottom: 14px;
    }

    .line {
      display: flex;
      justify-content: space-between;
      padding: 6px 0;
      font-size: 15px;
    }

    .next {
      margin-top: 12px;
      padding-top: 8px;
      border-top: 1px solid #1f2937;
      font-size: 13px;
      color: #a5b4fc;
    }
  </style>
</head>

<body>
  <div class="container">

    <!-- ARGENTEUIL TODAY -->
    <div class="card">
      <div class="title">Horaires de prière</div>
      <div class="city">Argenteuil (Aujourd'hui)</div>
      <div class="date" id="date-arg-now"></div>

      <div class="line"><span>Fajr</span><span id="arg-now-fajr">--:--</span></div>
      <div class="line"><span>Chourouq</span><span id="arg-now-sunrise">--:--</span></div>
      <div class="line"><span>Dhouhr</span><span id="arg-now-dhuhr">--:--</span></div>
      <div class="line"><span>Asr</span><span id="arg-now-asr">--:--</span></div>
      <div class="line"><span>Maghreb</span><span id="arg-now-maghrib">--:--</span></div>
      <div class="line"><span>Icha</span><span id="arg-now-isha">--:--</span></div>

      <div class="next" id="arg-now-next"></div>
    </div>

    <!-- PARIS TODAY -->
    <div class="card">
      <div class="title">Horaires de prière</div>
      <div class="city">Paris (Aujourd'hui)</div>
      <div class="date" id="date-par-now"></div>

      <div class="line"><span>Fajr</span><span id="par-now-fajr">--:--</span></div>
      <div class="line"><span>Chourouq</span><span id="par-now-sunrise">--:--</span></div>
      <div class="line"><span>Dhouhr</span><span id="par-now-dhuhr">--:--</span></div>
      <div class="line"><span>Asr</span><span id="par-now-asr">--:--</span></div>
      <div class="line"><span>Maghreb</span><span id="par-now-maghrib">--:--</span></div>
      <div class="line"><span>Icha</span><span id="par-now-isha">--:--</span></div>

      <div class="next" id="par-now-next"></div>
    </div>

    <!-- ARGENTEUIL TOMORROW -->
    <div class="card">
      <div class="title">Horaires de prière</div>
      <div class="city">Argenteuil (Demain)</div>
      <div class="date" id="date-arg-tom"></div>

      <div class="line"><span>Fajr</span><span id="arg-tom-fajr">--:--</span></div>
      <div class="line"><span>Chourouq</span><span id="arg-tom-sunrise">--:--</span></div>
      <div class="line"><span>Dhouhr</span><span id="arg-tom-dhuhr">--:--</span></div>
      <div class="line"><span>Asr</span><span id="arg-tom-asr">--:--</span></div>
      <div class="line"><span>Maghreb</span><span id="arg-tom-maghrib">--:--</span></div>
      <div class="line"><span>Icha</span><span id="arg-tom-isha">--:--</span></div>
    </div>

    <!-- PARIS TOMORROW -->
    <div class="card">
      <div class="title">Horaires de prière</div>
      <div class="city">Paris (Demain)</div>
      <div class="date" id="date-par-tom"></div>

      <div class="line"><span>Fajr</span><span id="par-tom-fajr">--:--</span></div>
      <div class="line"><span>Chourouq</span><span id="par-tom-sunrise">--:--</span></div>
      <div class="line"><span>Dhouhr</span><span id="par-tom-dhuhr">--:--</span></div>
      <div class="line"><span>Asr</span><span id="par-tom-asr">--:--</span></div>
      <div class="line"><span>Maghreb</span><span id="par-tom-maghrib">--:--</span></div>
      <div class="line"><span>Icha</span><span id="par-tom-isha">--:--</span></div>
    </div>

  </div>

  <script>

    /* FUNCTION : API sans proxy, fonctionne GitHub */
    async function fetchTimings(address, dayOffset = 0) {
      const date = new Date();
      date.setDate(date.getDate() + dayOffset);

      const d = date.getDate();
      const m = date.getMonth() + 1;
      const y = date.getFullYear();

      const url =
        `https://api.aladhan.com/v1/timingsByAddress/${d}-${m}-${y}?address=${encodeURIComponent(address)}&method=12`;

      const resp = await fetch(url);
      const data = await resp.json();

      if (!data || !data.data) {
        return null;
      }

      return { timings: data.data.timings, dateObj: date };
    }


    function fill(prefix, t, dateObj) {
      const opts = { weekday:"long", year:"numeric", month:"long", day:"numeric" };

      document.getElementById(`date-${prefix}`).textContent =
        dateObj.toLocaleDateString("fr-FR", opts);

      document.getElementById(`${prefix}-fajr`).textContent = t.Fajr;
      document.getElementById(`${prefix}-sunrise`).textContent = t.Sunrise;
      document.getElementById(`${prefix}-dhuhr`).textContent = t.Dhuhr;
      document.getElementById(`${prefix}-asr`).textContent = t.Asr;
      document.getElementById(`${prefix}-maghrib`).textContent = t.Maghrib;
      document.getElementById(`${prefix}-isha`).textContent = t.Isha;
    }

    function nextPrayer(prefix, t) {
      const now = new Date();
      const today = now.toISOString().split("T")[0];

      const list = [
        {name:"Fajr", time:t.Fajr},
        {name:"Dhouhr", time:t.Dhuhr},
        {name:"Asr", time:t.Asr},
        {name:"Maghreb", time:t.Maghrib},
        {name:"Icha", time:t.Isha},
      ];

      let next = null;

      for (let e of list) {
        const dt = new Date(`${today}T${e.time}:00`);
        if (dt > now) { next = e; break; }
      }

      document.getElementById(`${prefix}-next`).textContent =
        next ? `Prochaine : ${next.name} à ${next.time}` :
               "Toutes les prières sont passées aujourd'hui.";
    }


    async function loadAll() {

      /* ARGENTEUIL AUJOURD'HUI */
      const argNow = await fetchTimings("Argenteuil, France", 0);
      fill("arg-now", argNow.timings, argNow.dateObj);
      nextPrayer("arg-now", argNow.timings);

      /* PARIS AUJOURD'HUI */
      const parNow = await fetchTimings("Paris, Île-de-France, France", 0);
      fill("par-now", parNow.timings, parNow.dateObj);
      nextPrayer("par-now", parNow.timings);

      /* ARGENTEUIL DEMAIN */
      const argTom = await fetchTimings("Argenteuil, France", 1);
      fill("arg-tom", argTom.timings, argTom.dateObj);

      /* PARIS DEMAIN (adresse complète indispensable) */
      const parTom = await fetchTimings("Paris, Île-de-France, France", 1);
      fill("par-tom", parTom.timings, parTom.dateObj);
    }

    loadAll();
  </script>

</body>
</html>
